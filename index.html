<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Roleta de Pr√™mios Realista</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      background: #f9f9f9;
      margin: 0;
      padding: 40px 0;
    }
    .container {
      max-width: 360px;
      margin: 0 auto;
      position: relative;
      padding: 0 10px;
    }
    h1 {
      margin-bottom: 10px;
      font-size: 1.6rem;
      color: #222;
    }
    .info-text {
      font-size: 1.3rem;
      font-weight: 700;
      margin-bottom: 20px;
      color: #333;
    }
    .roleta {
      position: relative;
      width: 360px;
      height: 360px;
      margin: 0 auto;
      border-radius: 50%;
      box-shadow: 0 0 15px gold;
      border: 8px solid #b8860b;
      overflow: hidden;
      background: white;
    }
    #canvas {
      display: block;
      margin: 0 auto;
      border-radius: 50%;
      width: 100%;
      height: 100%;
    }
    .seta {
      position: absolute;
      top: 50%;
      right: -50px;
      width: 0;
      height: 0;
      border-left: 30px solid transparent;
      border-right: 30px solid transparent;
      border-bottom: 40px solid red;
      transform: translateY(-50%);
      filter: drop-shadow(1px 1px 2px #880000);
      z-index: 10;
    }
    #girar {
      margin-top: 30px;
      background-color: #ff9500;
      border: none;
      padding: 15px 40px;
      font-size: 20px;
      font-weight: bold;
      color: white;
      border-radius: 10px;
      cursor: pointer;
      box-shadow: 0 5px 0 #c66d00;
    }
    #girar:disabled {
      background-color: #ccc;
      cursor: not-allowed;
      box-shadow: none;
    }

    /* Quadro fora da roleta */
    .mensagem {
      margin-top: 30px;
      background: #fff;
      padding: 20px;
      border: 3px solid #007bff;
      border-radius: 10px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      font-size: 18px;
      font-weight: bold;
      color: #222;
      max-width: 340px;
      margin-left: auto;
      margin-right: auto;
      display: none;
    }
    .mensagem a {
      display: block;
      margin-top: 12px;
      background-color: #28a745;
      padding: 10px 15px;
      color: white;
      text-decoration: none;
      border-radius: 6px;
      font-weight: bold;
    }

    @media (max-width: 400px) {
      .roleta {
        width: 280px;
        height: 280px;
      }
      .seta {
        right: -40px;
        border-left: 25px solid transparent;
        border-right: 25px solid transparent;
        border-bottom: 33px solid red;
      }
      #girar {
        font-size: 18px;
        padding: 12px 30px;
      }
      .mensagem {
        font-size: 16px;
        max-width: 260px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Gire a Roleta e Ganhe!</h1>
    <div class="info-text">Tente a sua sorte!</div>
    <div class="roleta">
      <canvas id="canvas" width="360" height="360"></canvas>
      <div class="seta" title="Seta Indicadora"></div>
    </div>
    <button id="girar">GIRAR</button>

    <!-- Mensagem abaixo da roleta -->
    <div class="mensagem" id="mensagem"></div>
  </div>

  <!-- √Åudios -->
  <audio id="audio-giro" loop>
    <source src="https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg" type="audio/ogg">
  </audio>
  <audio id="audio-campainha">
    <source src="https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg" type="audio/ogg">
  </audio>

  <script>
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    const btnGirar = document.getElementById('girar');
    const mensagem = document.getElementById('mensagem');
    const audioGiro = document.getElementById('audio-giro');
    const audioCampainha = document.getElementById('audio-campainha');

    const premios = [
      { texto: '10 Meticais', cor: '#ff3b3b' },
      { texto: '100 Meticais', cor: '#3bbf3b' },
      { texto: '500 Meticais', cor: '#3b6fff' },
      { texto: 'Boa Sorte', cor: '#f9d94c' },
      { texto: '500 Meticais', cor: '#3bbf3b' },
      { texto: '10000 Meticais', cor: '#3b6fff' },
      { texto: '5000 Meticais', cor: '#ff3b3b' },
      { texto: '1000 Meticais', cor: '#f9d94c' },
    ];

    const numFatias = premios.length;
    const anguloPorFat = (2 * Math.PI) / numFatias;
    let rotacaoAtual = 0;
    let tentativas = 0;
    const maxTentativas = 2;

    function desenharRoleta() {
      const centroX = canvas.width / 2;
      const centroY = canvas.height / 2;
      const raio = canvas.width / 2;

      ctx.clearRect(0, 0, canvas.width, canvas.height);

      for (let i = 0; i < numFatias; i++) {
        const inicioAng = i * anguloPorFat;
        const fimAng = inicioAng + anguloPorFat;

        ctx.beginPath();
        ctx.moveTo(centroX, centroY);
        ctx.arc(centroX, centroY, raio, inicioAng, fimAng);
        ctx.fillStyle = premios[i].cor;
        ctx.fill();
        ctx.strokeStyle = '#fff';
        ctx.lineWidth = 2;
        ctx.stroke();

        ctx.save();
        ctx.translate(centroX, centroY);
        ctx.rotate(inicioAng + anguloPorFat / 2);
        ctx.textAlign = 'right';
        ctx.fillStyle = '#000';
        ctx.font = 'bold 18px Arial';
        ctx.fillText(premios[i].texto, raio - 15, 10);
        ctx.restore();
      }
    }

    function girarRoleta() {
      if (tentativas >= maxTentativas) return;

      btnGirar.disabled = true;
      mensagem.style.display = 'none';

      audioGiro.currentTime = 0;
      audioGiro.play();

      let fatiaDestino;

      if (tentativas === 0) {
        fatiaDestino = premios.findIndex(p => p.texto === 'Boa Sorte');
      } else {
        const opcoes = ['5000 Meticais', '10000 Meticais'];
        const escolha = opcoes[Math.floor(Math.random() * opcoes.length)];
        fatiaDestino = premios.findIndex(p => p.texto === escolha);
      }

      const anguloDestino = (numFatias - fatiaDestino) * anguloPorFat - (anguloPorFat / 2);
      const giros = Math.floor(Math.random() * 2) + 5;
      const duracao = 5000;

      const inicio = performance.now();
      const rotacaoInicial = rotacaoAtual;
      const rotacaoFinal = (giros * 2 * Math.PI) + anguloDestino;

      function animar(now) {
        const tempoDecorrido = now - inicio;
        if (tempoDecorrido < duracao) {
          const t = tempoDecorrido / duracao;
          const easing = 1 - Math.pow(1 - t, 3);
          rotacaoAtual = rotacaoInicial + easing * (rotacaoFinal - rotacaoInicial);
          canvas.style.transform = `rotate(${rotacaoAtual}rad)`;
          requestAnimationFrame(animar);
        } else {
          rotacaoAtual = rotacaoFinal % (2 * Math.PI);
          canvas.style.transform = `rotate(${rotacaoAtual}rad)`;
          audioGiro.pause();
          mostrarResultado(fatiaDestino);
          tentativas++;
          btnGirar.disabled = false;
        }
      }
      requestAnimationFrame(animar);
    }

    function mostrarResultado(index) {
      const premio = premios[index];
      mensagem.style.display = 'block';

      if (tentativas === 1) {
        mensagem.innerHTML = `
          Parou em: <strong>${premio.texto}</strong><br>
          Boa sorte!<br><small style="color: #888;">Tenta novamente</small>
        `;
      } else {
        audioCampainha.currentTime = 0;
        audioCampainha.play();
        mensagem.innerHTML = `
          üéâ <strong>Parab√©ns por se tornar o novo vendedor!</strong><br><br>
          Caro usu√°rio, ap√≥s o seu registo fa√ßa um dep√≥sito m√≠nimo de <strong>10 Mts</strong> e aguarde pacientemente.
          <a href="https://is.gd/hHdRiZ" target="_blank">Registar</a>
        `;
      }
    }

    btnGirar.addEventListener('click', girarRoleta);

    desenharRoleta();
  </script>
</body>
</html>
